[
  {
    "Id": "226751",
    "ThreadId": "66710",
    "Html": "<p>Is there a reason that the snippet editor does not load the user's personal snippets directory?&nbsp; It would seem that this would be an important snippet directory to load each time the snippet editor runs since that is where the user typically stores personal snippets.&nbsp; All that gets loaded are the built-in snippets.&nbsp; I am using Visudal Basic Express 2008 if that matters.</p>\r\n<p>Thanks for any info.</p>",
    "PostedDate": "2009-08-22T19:53:59.98-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "226895",
    "ThreadId": "66710",
    "Html": "Hi DrMajSir,<br><br>In Visual Studio click on the Tools menu and open the &quot;Code Snippets<br>Manager&quot; and check to see if the user's personal snippet directory is<br>there. If you add it, the change won't propagate until after Visual Studio<br>is closed.",
    "PostedDate": "2009-08-23T18:39:35.853-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "229028",
    "ThreadId": "66710",
    "Html": "Hi Akhmetov,<br><br>The problem with the code you added is it forces all paths in the users<br>documents folder to have &quot;Visual Studio 2008&quot; added to it.  This is wrong on<br>a number of counts. First we support multiple versions of Visual Studio.<br>Second, but most importantly, users can add other paths, anywhere on their<br>file system including anywhere in the My Documents folder, so you cannot<br>force the &quot;Visual Studio 2008&quot; into all paths.<br>The problem is not with the code, it is with the registry settings.  Open up<br>the &quot;Code Snippets Manager&quot; from inside Visual Studio, add the proper path,<br>close Visual Studio and restart.",
    "PostedDate": "2009-08-29T16:54:07.15-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "229212",
    "ThreadId": "66710",
    "Html": "<p>Hi Bill and Akhmetov,</p>\r\n<p>I'm not sure that I understand all that Akhmetov is saying in his posts.&nbsp; To answer Bill's question:</p>\r\n<p>Yes, my personal snippets directory is in the MS Visual Basic 2008 Express Edition Code Snippets Manager.&nbsp; In fact, it has been there ever since VB 2008 Express was installed on my computer.&nbsp; (i.e. it was installed as a default during the installation process)&nbsp; If it helps, here is the path:&nbsp;</p>\r\n<p>C:\\Users\\DrMajSir\\Documents\\Visual Studio 2008\\Code Snippets\\Visual Basic\\My Code Snippets</p>\r\n<p>I first discovered this problem when I added another path to the Code Snippets Manager.&nbsp; (One I had created for some snippets I downloaded for a book I'm reading on VB 2008)&nbsp; I was able to successfully added the new directory into VB 2008 Express.&nbsp; However, every time I loaded up the code snippets editor, the directory I manually added to VB 2008 using the snippets manager, mysteriously disapeared when I would reopen VB 2008.&nbsp; After going back and forth bewteen the code snippet editor and VB 2008 several times, I was able to deduce that the code snippet editor was the one removing the manually added directory.&nbsp; It was during this &quot;testing&quot; that I noticed that the code snippet editor did not load the &quot;My Code Snippets&quot; directory.&nbsp; So I decided to move the other snippet directory I had downloaded to be a sub-directory under &quot;My Code Snippet&quot;.&nbsp; VB 2008 Express was happy and the code snippet editor stopped removing the reference.&nbsp; (I suspect partly becuase it doesn't even find the &quot;My Code Snippets&quot; directory.)&nbsp; However, this &quot;fix&quot; for the dissappearing directory (from VB 2008) is not really a solution because it now means that only the built-in code snippets are available within the code snippet editor.</p>\r\n<p>Bill:&nbsp; What is your suggested solution?&nbsp; Assuming you have one.</p>\r\n<p>Thanks,<br>DrMajSir</p>",
    "PostedDate": "2009-08-30T23:48:45.157-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "229229",
    "ThreadId": "66710",
    "Html": "Hi DrMajSir,<br><br>It sounds like the registry maybe being re-initialized.  This may-be due to<br>the express versions showing other languages as being installed even though<br>they aren't.<br><br>Try setting a break point on line 435 of the Products.vb file and launch<br>from the IDE in debug mode.<br>    <br>   If regKey Is Nothing OrElse regKey.ValueCount = 0 Then<br>--&gt;     If Me.IsInstalled Then Me.Product.InitializeUserRegistry()<br>   End If<br><br>If the Me.Product.InitializeUserRegistry is being called, then that's the<br>likely culprit. I'd hazard a guess it's getting bad product/language<br>information.  Make a note of the product and the language: language would be<br>the Me reference at the breakpoint, and the product can be obtained via the<br>Me.Product.<br>Once you've determined that, investigate the registry and see if you can<br>find the rogue language entry and report back your findings.  <br><br>Also, can you tell me what products are listed in the drop down combo on the<br>left hand side of the Snippet Editor ?, eg: &quot;Visual Studio 2008&quot;, &quot;Visual<br>Basic 2008 Express Edition&quot; etc ..<br><br>At this point of time without actually knowing what is causing the problem,<br>my guess is it will be around the call to InitializeUserRegistry.  The<br>problem with that method  being is it resets the entire product rather than<br>per language per product. So simple fix would be to refactor the method to<br>take a language and only initialize one language per call.",
    "PostedDate": "2009-08-31T01:05:12.583-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "229551",
    "ThreadId": "66710",
    "Html": "<p>Bill,</p>\r\n<p>I did as you requested and the program stopped at the line you indicated.&nbsp; I took a snapshot of the screen showing the me reference expanded in the locals window.&nbsp; However, I can't figure out a way to attach it to a posting (maybe that's by design!)&nbsp; However, I did upload it to a private Picasa Web Album which should be reachable by clicking below.</p>\r\n<table style=\"width:194px\" border=0>\r\n<tbody>\r\n<tr>\r\n<td style=\"height:194px\" align=center><a href=\"http://picasaweb.google.com/drjpmeyers/VisualBasic?authkey=Gv1sRgCMuft5z54d2REw&feat=embedwebsite\"><img style=\"margin:1px 0 0 4px\" src=\"http://lh5.ggpht.com/_Yo51B6rUbL0/SpyOig7blsE/AAAAAAAABjQ/M098migHwEQ/s160-c/VisualBasic.jpg\" alt=\"\" width=160 height=160></a></td>\r\n</tr>\r\n<tr>\r\n<td style=\"text-align:center;font-family:arial,sans-serif;font-size:11px\"><a style=\"color:#4D4D4D;font-weight:bold;text-decoration:none\" href=\"http://picasaweb.google.com/drjpmeyers/VisualBasic?authkey=Gv1sRgCMuft5z54d2REw&feat=embedwebsite\">Visual Basic</a></td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n<p>I hope this helps!</p>",
    "PostedDate": "2009-08-31T20:06:09.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "229687",
    "ThreadId": "66710",
    "Html": "Hi DrMajSir,<br><br>It does help some.  The problem appears to be in finding the localised name<br>for CSharp.  It should be something like &quot;Visual C#&quot;. <br>Why VB Express is reporting Visual C# as being installed is a question I<br>can't answer ;)   If you can, put a break point on the GetLocalisedName<br>method and see what is going on there.<br><br>The refactoring I mentioned earlier to initialize the registry per language<br>instead of per product will fix the problem you are having but it doesn't<br>get to the underlying issue of why C# is reported as being installed, yet<br>the localized name fails. I'd be concerned if the LCID is being reported<br>wrong.  If it fails to find the C# resource assembly in GetLocalisedName,<br>does it find the VB one ?<br><br>Thanks",
    "PostedDate": "2009-09-01T05:55:09.02-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230064",
    "ThreadId": "66710",
    "Html": "<p>Bill,</p>\r\n<p>I did as you requested and placed a break point on GetLocalisedName.&nbsp; The program calls the function three times and stepping through it produces the following set of changes to variables:</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>1st visit <span style=\"color:Blue\">to</span> GetLocalisedName:\r\n<span style=\"color:Blue\">Me</span> = \r\n\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t\tLocalisedName\t<span style=\"color:#A31515\">&quot;Visual Basic&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tName\t<span style=\"color:#A31515\">&quot;Basic&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n+\t\tProduct\t{SnippetEditor.Utility.Product}\tSnippetEditor.Utility.Product\r\n\t\t\tHKLMRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t+\t\tLanguages\t<span style=\"color:Blue\">Count</span> = 3\tSnippetEditor.Utility.Language.LanguageCollection\r\n\t\t\tLCID\t1033\t<span style=\"color:Blue\">Integer</span>\r\n\t\t\tName\t<span style=\"color:#A31515\">&quot;Visual Basic 2008 Express Edition&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSnippetsPath\t<span style=\"color:#A31515\">&quot;%InstallRoot%\\VB\\Snippets\\%LCID%\\WPF\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\application\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\common code patterns\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\data\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\fundamentals\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\other\\;%InstallRoot%\\Common7\\IDE\\VBExpress\\Snippets\\%LCID%\\windowsforms\\;%MyDocs%\\Code Snippets\\Visual Basic\\My Code Snippets\\;&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nNOTE:  The last directory <span style=\"color:Blue\">in</span> the SnippetsPath above should be:\r\n\t%MyDocs%\\Visual Studio 2008\\Code Snippets\\Visual Basic\\<span style=\"color:Blue\">My</span> Code Snippets\r\n\t(i.e. it appears <span style=\"color:Blue\">to</span> be missing the <span style=\"color:#A31515\">&quot;Visual Studio 2008&quot;</span> portion)\r\n\r\nrootKey =\r\n \t\tName\t<span style=\"color:#A31515\">&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0\\Languages\\CodeExpansions\\Basic&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSubKeyCount\t2\t<span style=\"color:Blue\">Integer</span>\r\n\t\tValueCount\t7\t<span style=\"color:Blue\">Integer</span>\r\n\r\nresIDString =\t<span style=\"color:#A31515\">&quot;1533&quot;</span>\t<span style=\"color:Blue\">String</span>\r\npackage =\t<span style=\"color:#A31515\">&quot;{019971D6-4685-11D2-B48A-0000F87572EB}&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\npackageKey =\t{Microsoft.Win32.RegistryKey}\tMicrosoft.Win32.RegistryKey\r\n\t\t\tName\t<span style=\"color:#A31515\">&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0\\Packages\\{019971D6-4685-11D2-B48A-0000F87572EB}\\SatelliteDll&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tSubKeyCount\t0\t<span style=\"color:Blue\">Integer</span>\r\n\t\t\tValueCount\t2\t<span style=\"color:Blue\">Integer</span>\r\n\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\&quot;</span>\t<span style=\"color:Blue\">String</span>\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\1033&quot;</span>\t<span style=\"color:Blue\">String</span>\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\1033\\msvb7ui.dll&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nresIDString =\t<span style=\"color:#A31515\">&quot;Visual Basic&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\n<span style=\"color:Blue\">End</span> of 1st visit <span style=\"color:Blue\">to</span> GetLocalisedName\r\n\r\n\r\n\r\n2nd visit <span style=\"color:Blue\">to</span> GetLocalisedName:\r\n<span style=\"color:Blue\">Me</span> = \r\n\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t\tLocalisedName\t<span style=\"color:#A31515\">&quot;CSharp&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tName\t<span style=\"color:#A31515\">&quot;CSharp&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n+\t\tProduct\t{SnippetEditor.Utility.Product}\tSnippetEditor.Utility.Product\r\n\t\t\tHKLMRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t+\t\tLanguages\t<span style=\"color:Blue\">Count</span> = 3\tSnippetEditor.Utility.Language.LanguageCollection\r\n\t\t\tLCID\t1033\t<span style=\"color:Blue\">Integer</span>\r\n\t\t\tName\t<span style=\"color:#A31515\">&quot;Visual Basic 2008 Express Edition&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSnippetsPath\t<span style=\"color:#A31515\">&quot;&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nrootKey =\r\n\t\tName\t<span style=\"color:#A31515\">&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0\\Languages\\CodeExpansions\\CSharp&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSubKeyCount\t1\t<span style=\"color:Blue\">Integer</span>\r\n\t\tValueCount\t0\t<span style=\"color:Blue\">Integer</span>\r\n\r\nresIDString =\t<span style=\"color:#A31515\">&quot;&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nNote:  The IsNumeric test <span style=\"color:Blue\">on</span> line 409 fails <span style=\"color:Blue\">and</span> the <span style=\"color:Blue\">function</span> returns:  <span style=\"color:#A31515\">&quot;&quot;</span>\r\n\r\n<span style=\"color:Blue\">End</span> of 2nd visit <span style=\"color:Blue\">to</span> GetLocalisedName\r\n\r\n\r\n\r\n3rd visit <span style=\"color:Blue\">to</span> GetLocalisedName:\r\n<span style=\"color:Blue\">Me</span> =\r\n\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t\tLocalisedName\t<span style=\"color:#A31515\">&quot;XML&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tName\t<span style=\"color:#A31515\">&quot;XML&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n+\t\tProduct\t{SnippetEditor.Utility.Product}\tSnippetEditor.Utility.Product\r\n\t\t\tHKLMRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tIsInstalled\t<span style=\"color:Blue\">True</span>\t<span style=\"color:Blue\">Boolean</span>\r\n\t+\t\tLanguages\t<span style=\"color:Blue\">Count</span> = 3\tSnippetEditor.Utility.Language.LanguageCollection\r\n\t\t\tLCID\t1033\t<span style=\"color:Blue\">Integer</span>\r\n\t\t\tName\t<span style=\"color:#A31515\">&quot;Visual Basic 2008 Express Edition&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\t\tRegistryPath\t<span style=\"color:#A31515\">&quot;SOFTWARE\\Microsoft\\VBExpress\\9.0&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSnippetsPath\t<span style=\"color:#A31515\">&quot;%InstallRoot%\\xml\\%LCID%\\Snippets\\;%MyDocs%\\Code Snippets\\XML\\My Xml Snippets\\;&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nNOTE:  The last directory <span style=\"color:Blue\">in</span> the SnippetsPath above should be:\r\n\t%MyDocs%Visual Studio 2008\\Code Snippets\\XML\\<span style=\"color:Blue\">My</span> Xml Snippets\r\n\t(i.e. it appears <span style=\"color:Blue\">to</span> be missing the <span style=\"color:#A31515\">&quot;Visual Studio 2008&quot;</span> portion)\r\n\r\nrootKey =\r\n\t\tName\t<span style=\"color:#A31515\">&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0\\Languages\\CodeExpansions\\XML&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSubKeyCount\t2\t<span style=\"color:Blue\">Integer</span>\r\n\t\tValueCount\t6\t<span style=\"color:Blue\">Integer</span>\r\n\r\nresIDString =\t<span style=\"color:#A31515\">&quot;#200&quot;</span>\t<span style=\"color:Blue\">String</span>\r\nresIDString =\t<span style=\"color:#A31515\">&quot;200&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nid =\t\t200\t<span style=\"color:Blue\">UInteger</span>\r\n\r\npackage =\t<span style=\"color:#A31515\">&quot;{87569308-4813-40a0-9cd0-d7a30838ca3f}&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\npackageKey =\r\n\t\tName\t<span style=\"color:#A31515\">&quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\VBExpress\\9.0\\Packages\\{87569308-4813-40a0-9cd0-d7a30838ca3f}\\SatelliteDll&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\t\tSubKeyCount\t0\t<span style=\"color:Blue\">Integer</span>\r\n\t\tValueCount\t2\t<span style=\"color:Blue\">Integer</span>\r\n\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\Xml\\&quot;</span>\t<span style=\"color:Blue\">String</span>\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\Xml\\1033&quot;</span>\t<span style=\"color:Blue\">String</span>\r\npath =\t\t<span style=\"color:#A31515\">&quot;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\Xml\\1033\\Microsoft.XmlEditorUI.dll&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\nresIDString =\t<span style=\"color:#A31515\">&quot;XML&quot;</span>\t<span style=\"color:Blue\">String</span>\r\n\r\n<span style=\"color:Blue\">End</span> of 3rd visit <span style=\"color:Blue\">to</span> GetLocalisedName\r\n\r\n<br>Again, I hope this helps.  While I was collecting this information, I noticed that all though Visual C# is NOT installed on my machine, <br>there are Visual C# sub-directories the Code Snippets and Templates directories within my Visual Studio 2008 directory in my &quot;Documents&quot; <br>folder.<br><br>DrMajSir<br></pre>\r\n</div>\r\n</p>",
    "PostedDate": "2009-09-02T01:05:15.487-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230157",
    "ThreadId": "66710",
    "Html": "Hi DrMajSir,<br><br>Thanks !!  So the problem is the registry is showing CSharp in the HKLM<br>CodeExpansions, but it doesn't have the necessary information such as<br>DisplayName or Package etc.  So really the Snippet Editor should be ignoring<br>that CSharp entry.  I think the following replacement of the IsInstalled<br>method, line 331 of products.vb will fix that part of the problem..<br><br>      Public ReadOnly Property IsInstalled() As Boolean<br>         Get<br>            Using languageKey As RegistryKey =<br>Registry.LocalMachine.OpenSubKey(Me.Product.HKLMRegistryPath & &quot;\\&quot; &<br>Me.Product.CodeExpansionsPath & &quot;\\&quot; & Me.Name, False)<br>               Return CStr(languageKey.GetValue(&quot;DisplayName&quot;, &quot;&quot;)) &lt;&gt;<br>Nothing<br>            End Using<br>         End Get<br>      End Property<br><br><br><br>The second part of the problem is the &quot;Visual Studio 2008&quot; missing from the<br>snippet path.  That's due to what Visual Studio interprets %My Docs% as<br>meaning.  It seems in some cases it interprets it as the My Documents<br>folder, and in others My Documents\\Visual Studio 2008. I'll have to look<br>into that one further.  In the meanwhile add the folder from inside the<br>snippet editor and it should be okay.",
    "PostedDate": "2009-09-02T05:16:36.667-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230189",
    "ThreadId": "66710",
    "Html": "\r\n\r\n<div class=Section1>\r\n\r\n<p class=MsoPlainText>Regarding the missing &quot;Visual Studio 2008&quot; in\r\nsome paths, that's a problem with the %MyDocs% replacement variable.  To Fix,\r\nchange the ReplaceVars function to the following:  </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText>Line 373 of Products.vb: </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">     \r\n<span style=\"color:#3092B1\">Private</span> <span style=\"color:#3092B1\">Function</span>\r\nReplaceVars(<span style=\"color:#3092B1\">ByVal</span> strIn <span style=\"color:#3092B1\">As</span> <span style=\"color:#3092B1\">String</span>) <span style=\"color:#3092B1\">As</span> <span style=\"color:#3092B1\">String</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">Dim</span> strOut <span style=\"color:#3092B1\">As</span>\r\n<span style=\"color:#3092B1\">String</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">If</span> strIn = <span style=\"color:#3092B1\">Nothing</span>\r\n<span style=\"color:#3092B1\">Then</span> <span style=\"color:#3092B1\">Return</span>\r\n<span style=\"color:#A31515;background:yellow\">&quot;&quot;</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\nstrOut = strIn.Replace(<span style=\"color:#A31515;background:yellow\">&quot;%MyDocs%&quot;</span>, GetMyDocs)</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\nstrOut = strOut.Replace(<span style=\"color:#A31515;background:yellow\">&quot;%InstallRoot%\\&quot;</span>, GetInstallRoot)</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\nstrOut = strOut.Replace(<span style=\"color:#A31515;background:yellow\">&quot;%LCID%&quot;</span>, <span style=\"color:#3092B1\">Me</span>.Product.LCID.ToString)</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">Return</span> strOut</span></p>\r\n\r\n<p class=MsoPlainText>      <span style=\"color:#3092B1\">End</span>\r\n<span style=\"color:#3092B1\">Function</span></p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText>And then add the following function:</p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">     \r\n<span style=\"color:#3092B1\">Private</span> <span style=\"color:#3092B1\">Function</span>\r\nGetMyDocs() <span style=\"color:#3092B1\">As</span> <span style=\"color:#3092B1\">String</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">If</span> <span style=\"color:#3092B1\">Me</span>.Product\r\n<span style=\"color:#3092B1\">Is</span> <span style=\"color:#3092B1\">Nothing</span>\r\n<span style=\"color:#3092B1\">Then</span> <span style=\"color:#3092B1\">Return</span>\r\n<span style=\"color:#3092B1\">My</span>.Computer.FileSystem.SpecialDirectories.MyDocuments</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">Dim</span> docsPath <span style=\"color:#3092B1\">As</span>\r\n<span style=\"color:#3092B1\">String</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">Using</span> hkey <span style=\"color:#3092B1\">As</span>\r\nRegistryKey = Registry. CurrentUser.OpenSubKey(<span style=\"color:#3092B1\">Me</span>.Product.RegistryPath)</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">           \r\ndocsPath = hkey.GetValue(<span style=\"color:#A31515;background:yellow\">&quot;VisualStudioLocation&quot;</span>, <span style=\"color:#A31515;background:yellow\">&quot;&quot;</span>).ToString</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">End</span> <span style=\"color:#3092B1\">Using</span></span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">If</span> docsPath = <span style=\"color:#3092B1\">Nothing</span>\r\n<span style=\"color:#3092B1\">Then</span> docsPath = <span style=\"color:#3092B1\">My</span>.Computer.FileSystem.SpecialDirectories.MyDocuments</span></p>\r\n\r\n<p class=MsoNormal style=\"text-autospace:none\"><span style=\"font-family:Consolas\">        \r\n<span style=\"color:#3092B1\">Return</span> docsPath</span></p>\r\n\r\n<p class=MsoPlainText>      <span style=\"color:#3092B1\">End</span>\r\n<span style=\"color:#3092B1\">Function</span></p>\r\n\r\n<p class=MsoPlainText><span style=\"color:#3092B1\"> </span></p>\r\n\r\n<p class=MsoPlainText><span style=\"color:#3092B1\"> </span></p>\r\n\r\n<p class=MsoPlainText><span style=\"color:#3092B1\">NOTE: I havenâ€™t tested\r\nthis yet, but it looks like it should fix it.</span></p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n<p class=MsoPlainText><span style=\"color:#3092B1\"> </span></p>\r\n\r\n<p class=MsoPlainText> </p>\r\n\r\n</div>\r\n\r\n",
    "PostedDate": "2009-09-02T06:23:07.127-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230228",
    "ThreadId": "66710",
    "Html": "<p>I have updated the products.vb file.</p>\r\n<p><a href=\"http://snippeteditor.codeplex.com/SourceControl/changeset/view/36425#391917\">http://snippeteditor.codeplex.com/SourceControl/changeset/view/36425#391917</a></p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-02T07:55:57.277-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230477",
    "ThreadId": "66710",
    "Html": "<p>Bill,</p>\r\n<p>Awesome!&nbsp; I tested the new products.vb and I can confirm that it works.&nbsp; I can now add directories<br>either in the Snippets editor or VB and they are reflected in both programs during the next restart.</p>\r\n<p>The fix also made the My Snippets directory appear and removed the C Sharp directory.</p>\r\n<p>Thanks!</p>\r\n<p>DrMajSir</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-02T18:24:54.977-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "230491",
    "ThreadId": "66710",
    "Html": "Hi DrMajSir,<br><br>Thanks :)  <br><br>Glad you raised the bug and very appreciative of your help in tracking down<br>the cause.  Thanks :)",
    "PostedDate": "2009-09-02T20:07:56.583-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]